import{c as A,r as a,u as E,a as b,b as d,s as F,j as e,L as M,A as R,d as v,T as h,e as p,f as O,g as u,h as k,i as B,B as f,D as V,k as $,l as z,O as J,m as U}from"./index-4519c325.js";import{u as q,T as G,I as H}from"./index.esm-58d55961.js";import{M as K,a as Q,b as W,I as X,P as Y}from"./InfinityScroll-16258b4b.js";import{D as Z}from"./listItemIconClasses-1aa53eba.js";import"./GlobalStyles-9ea71070.js";const ee=A(s=>s.anime.anime,s=>s),se=A(s=>s.anime.isLoading,s=>s);class S{constructor({types:n,search:i}){this.types=n,this.search=i}}const te="_aside_1woft_1",ae="_form_1woft_14",j={aside:te,form:ae},ne="_animeCard_5ywm5_1",ie={animeCard:ne},oe=a.forwardRef(({anime:s},n)=>{const i=E(),r=b(),l=d(F),o=()=>{l&&r(O()),i(`${s.id}`)};return e.jsxs(M,{ref:n,alignItems:"flex-start",className:ie.animeCard,onClick:o,children:[e.jsx(R,{sx:{width:80,height:80},src:s.imageUrl}),e.jsx(v,{primary:e.jsxs(h,{sx:{display:"inline"},component:"h4",variant:"body2",color:"text.primary",children:[s.titleJapanese,e.jsx("br",{}),s.titleEnglish]}),secondary:e.jsxs(h,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:["Type: ",p.toReadable(s.type),e.jsx("br",{}),"Status: ",s.status]})})]})}),re=a.memo(oe),C=[{field:u.TitleEnglish,direction:""},{field:u.Status,direction:""}],y={pagination:new Y({pageSize:15,pageNumber:0}),sorting:C,filters:new S({types:[],search:""})},le={types:[],search:"",sorting:C},ce=()=>{const s=b(),n=d(ee),i=d(se),[r,l]=a.useState(!1),[o,x]=a.useState(y),[L,N]=a.useState(null),I=()=>{x(t=>({...t,pagination:{...t.pagination,pageNumber:t.pagination.pageNumber+1}}))};a.useEffect(()=>{s(k())},[]),a.useEffect(()=>{s(B(o))},[o]);const{register:w,handleSubmit:P,control:g}=q({defaultValues:le}),c=()=>{l(t=>!t)},D=({types:t,search:m,sorting:_})=>{s(U()),x({...y,sorting:_,filters:new S({types:t,search:m})}),c()},T=a.useCallback(t=>{N(t)},[]);return e.jsxs(f,{sx:{flex:1,display:"flex"},children:[e.jsx(V,{open:r,onClose:c,children:e.jsxs("form",{className:j.form,onSubmit:P(D),children:[e.jsx(G,{label:"Search",...w("search")}),e.jsx(K,{name:"types",toReadable:p.toReadable,control:g,items:p.toArray(),title:"Filter"}),e.jsx(Q,{name:"sorting",control:g,title:"Sorting",toReadable:u.toReadable}),e.jsx($,{type:"submit",children:"Apply"})]})}),e.jsxs("aside",{className:j.aside,children:[e.jsx(H,{onClick:c,children:e.jsx(W,{})}),e.jsx(X,{lastItemNode:L,onObserve:I,children:e.jsxs(e.Fragment,{children:[i&&n.length===0&&e.jsx(z,{}),n.map((t,m)=>e.jsxs(f,{children:[e.jsx(re,{ref:m===n.length-1?T:null,anime:t}),e.jsx(Z,{})]},t.id))]})})]}),e.jsx(J,{})]})},ge=a.memo(ce);export{ge as AnimePage};
