import{c as A,r as t,j as e,L as M,A as R,a as w,T as g,b as c,d as m,u as D,e as h,f as E,g as O,B as x,D as z,h as B,i as W,O as k,k as q}from"./index-8d4cfe93.js";import{u as V,T as J,I as U}from"./index.esm-2343ab60.js";import{M as $,a as G,b as H,I as K,P as Q}from"./InfinityScroll-10e60a22.js";import{D as X}from"./listItemIconClasses-626f2f8f.js";import"./GlobalStyles-f12eb909.js";const Y=A(s=>s.anime.anime,s=>s),Z=A(s=>s.anime.isLoading,s=>s);class b{constructor({types:n,search:r}){this.types=n,this.search=r}}const ee="_pageWrapper_1rzlc_1",se="_aside_1rzlc_6",ae="_form_1rzlc_16",l={pageWrapper:ee,aside:se,form:ae},te="_animeCard_hvndq_1",ne="_animeAvatar_hvndq_12",f={animeCard:te,animeAvatar:ne},re=t.forwardRef(({anime:s},n)=>e.jsxs(M,{ref:n,className:f.animeCard,children:[e.jsx(R,{className:f.animeAvatar,src:s.imageUrl}),e.jsx(w,{primary:e.jsxs(g,{component:"h4",variant:"body2",children:[s.titleJapanese,e.jsx("br",{}),s.titleEnglish]}),secondary:e.jsxs(g,{component:"span",variant:"body2",children:["Type: ",c.toReadable(s.type),e.jsx("br",{}),"Status: ",s.status]})})]})),ie=t.memo(re),y=[{field:m.TitleEnglish,direction:""},{field:m.Status,direction:""}],j={pagination:new Q({pageSize:15,pageNumber:0}),sorting:y,filters:new b({types:[],search:""})},oe={types:[],search:"",sorting:y},le=()=>{const s=D(),n=h(Y),r=h(Z),[S,_]=t.useState(!1),[d,p]=t.useState(j),[L,N]=t.useState(null),C=()=>{p(a=>({...a,pagination:{...a.pagination,pageNumber:a.pagination.pageNumber+1}}))};t.useEffect(()=>{s(E())},[]),t.useEffect(()=>{s(O(d))},[d]);const{register:I,handleSubmit:P,control:u}=V({defaultValues:oe}),i=()=>{_(a=>!a)},v=({types:a,search:o,sorting:T})=>{s(q()),p({...j,sorting:T,filters:new b({types:a,search:o})}),i()},F=t.useCallback(a=>{N(a)},[]);return e.jsxs(x,{className:l.pageWrapper,children:[e.jsx(z,{open:S,onClose:i,children:e.jsxs("form",{className:l.form,onSubmit:P(v),children:[e.jsx(J,{label:"Search",...I("search")}),e.jsx($,{name:"types",toReadable:c.toReadable,control:u,items:c.toArray(),title:"Filter"}),e.jsx(G,{name:"sorting",control:u,title:"Sorting",toReadable:m.toReadable}),e.jsx(B,{type:"submit",children:"Apply"})]})}),e.jsxs("aside",{className:l.aside,children:[e.jsx(U,{onClick:i,children:e.jsx(H,{})}),e.jsx(K,{lastItemNode:L,onObserve:C,children:e.jsxs(e.Fragment,{children:[r&&n.length===0&&e.jsx(W,{}),n.map((a,o)=>e.jsxs(x,{children:[e.jsx(ie,{ref:o===n.length-1?F:null,anime:a}),e.jsx(X,{})]},a.id))]})})]}),e.jsx(k,{})]})},ge=t.memo(le);export{ge as AnimePage};
