import{r as n,u as j,j as a,D as F,A as m,a as g,B as I,c as D,b as A,L as _,d as R,e as C,T as h,t as E,f,g as M,h as S,i as k,k as O,O as T}from"./index-4d8ea228.js";import{P as b,M as B,a as W,I as q,D as $}from"./InfinityScroll-147551c4.js";import{u as z,T as V,I as J}from"./index.esm-f1907a3b.js";import{M as U}from"./MultipleSelect-76aea492.js";class L{constructor({types:t,search:s}){this.types=t,this.search=s}}var u=(e=>(e.ChangePagination="change_pagination",e.ChangeSorting="change_sorting",e.ChangeFilter="change_filter",e.ChangeFilterAndSorting="change_filter_and_sorting",e))(u||{});const G=(e,t)=>{switch(t.type){case"change_pagination":return{...e,pagination:new b({...e.pagination,pageNumber:e.pagination.pageNumber+1})};case"change_sorting":return{...e,pagination:t.payload.defaultPagination,sorting:t.payload.sorting};case"change_filter":return{...e,pagination:t.payload.defaultPagination,filters:t.payload.filters};case"change_filter_and_sorting":return{...e,pagination:t.payload.defaultPagination,filters:t.payload.filters,sorting:t.payload.sorting};default:return e}},H="_pageWrapper_fzkaq_1",K={pageWrapper:H},Q="_form_1pkbk_1",X={form:Q},Y=({isOpened:e,toggleMenu:t,paramsDispatch:s,defaultFormValues:r,defaultParams:l})=>{const o=j(),{register:c,handleSubmit:p,control:i}=z({defaultValues:r}),d=({types:v,search:P,sorting:w})=>{o(D()),s({type:u.ChangeFilterAndSorting,payload:{sorting:w,defaultPagination:l.pagination,filters:new L({types:v,search:P})}}),t()};return a.jsx(F,{open:e,onClose:t,children:a.jsxs("form",{className:X.form,onSubmit:p(d),children:[a.jsx(V,{label:"Search",...c("search")}),a.jsx(U,{name:"types",toReadable:m.toReadable,control:i,items:m.toArray(),title:"Filter"}),a.jsx(B,{name:"sorting",control:i,title:"Sorting",toReadable:g.toReadable}),a.jsx(I,{type:"submit",children:"Apply"})]})})},Z=n.memo(Y),ee=A(e=>e.anime.anime,e=>e),ae=A(e=>e.anime.isLoading,e=>e),te="_aside_i7p1g_1",se={aside:te},ne="_animeCard_hvndq_1",ie="_animeAvatar_hvndq_12",x={animeCard:ne,animeAvatar:ie},re=n.forwardRef(({anime:e},t)=>a.jsxs(_,{ref:t,className:x.animeCard,children:[a.jsx(R,{className:x.animeAvatar,src:e.imageUrl}),a.jsx(C,{primary:a.jsxs(h,{component:"h4",variant:"body2",children:[e.titleJapanese,a.jsx("br",{}),e.titleEnglish]}),secondary:a.jsxs(h,{component:"span",variant:"body2",children:["Type: ",m.toReadable(e.type),a.jsx("br",{}),"Status: ",e.status]})})]})),oe=n.memo(re),le=()=>a.jsx(_,{children:a.jsx(C,{primary:"Try more!",secondary:"Nothing found"})}),ce=E(le),pe=({toggleMenu:e,paramsDispatch:t})=>{const s=f(ee),r=f(ae),[l,o]=n.useState(null),c=()=>{t({type:u.ChangePagination})},p=n.useCallback(i=>{o(i)},[]);return a.jsxs("aside",{className:se.aside,children:[r&&s.length===0&&a.jsx(M,{}),a.jsx(J,{onClick:e,children:a.jsx(W,{})}),a.jsxs(q,{lastItemNode:l,onObserve:c,children:[s.length===0&&!r&&a.jsx(ce,{}),s.map((i,d)=>a.jsxs(S,{children:[a.jsx(oe,{ref:d===s.length-1?p:null,anime:i}),a.jsx($,{})]},i.id))]})]})},de=n.memo(pe),N=[{field:g.TitleEnglish,direction:""},{field:g.Status,direction:""}],y={pagination:new b({pageSize:15,pageNumber:0}),sorting:N,filters:new L({types:[],search:""})},me={types:[],search:"",sorting:N},ge=()=>{const e=j(),[t,s]=n.useReducer(G,y);n.useEffect(()=>{e(k())},[]),n.useEffect(()=>{e(O(t))},[t]);const[r,l]=n.useState(!1),o=()=>{l(c=>!c)};return a.jsxs(S,{className:K.pageWrapper,children:[a.jsx(Z,{paramsDispatch:s,toggleMenu:o,isOpened:r,defaultFormValues:me,defaultParams:y}),a.jsx(de,{paramsDispatch:s,toggleMenu:o}),a.jsx(T,{})]})},ye=n.memo(ge);export{ye as AnimePage};
