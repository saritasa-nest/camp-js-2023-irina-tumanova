import{c as j,r as a,j as e,L as T,A as M,a as R,T as x,b as l,d as c,u as D,e as u,f as E,g as O,B as g,D as B,h as k,i as v,O as V,k as z}from"./index-2355cab3.js";import{u as J,T as U,I as $}from"./index.esm-4b193a22.js";import{M as q,a as G,b as H,I as K,P as Q}from"./InfinityScroll-607cf9f7.js";import{D as W}from"./listItemIconClasses-35ceee90.js";import"./GlobalStyles-647f82ca.js";const X=j(s=>s.anime.anime,s=>s),Y=j(s=>s.anime.isLoading,s=>s);class y{constructor({types:n,search:i}){this.types=n,this.search=i}}const Z="_aside_138wd_1",ee="_form_138wd_10",h={aside:Z,form:ee},se="_animeCard_5ywm5_1",te={animeCard:se},ae=a.forwardRef(({anime:s},n)=>e.jsxs(T,{ref:n,alignItems:"flex-start",className:te.animeCard,children:[e.jsx(M,{sx:{width:80,height:80},src:s.imageUrl}),e.jsx(R,{primary:e.jsxs(x,{sx:{display:"inline"},component:"h4",variant:"body2",color:"text.primary",children:[s.titleJapanese,e.jsx("br",{}),s.titleEnglish]}),secondary:e.jsxs(x,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:["Type: ",l.toReadable(s.type),e.jsx("br",{}),"Status: ",s.status]})})]})),ne=a.memo(ae),b=[{field:c.TitleEnglish,direction:""},{field:c.Status,direction:""}],f={pagination:new Q({pageSize:15,pageNumber:0}),sorting:b,filters:new y({types:[],search:""})},ie={types:[],search:"",sorting:b},oe=()=>{const s=D(),n=u(X),i=u(Y),[A,S]=a.useState(!1),[m,d]=a.useState(f),[I,L]=a.useState(null),C=()=>{d(t=>({...t,pagination:{...t.pagination,pageNumber:t.pagination.pageNumber+1}}))};a.useEffect(()=>{s(E())},[]),a.useEffect(()=>{s(O(m))},[m]);const{register:w,handleSubmit:N,control:p}=J({defaultValues:ie}),o=()=>{S(t=>!t)},P=({types:t,search:r,sorting:F})=>{s(z()),d({...f,sorting:F,filters:new y({types:t,search:r})}),o()},_=a.useCallback(t=>{L(t)},[]);return e.jsxs(g,{sx:{flex:1,display:"flex"},children:[e.jsx(B,{open:A,onClose:o,children:e.jsxs("form",{className:h.form,onSubmit:N(P),children:[e.jsx(U,{label:"Search",...w("search")}),e.jsx(q,{name:"types",toReadable:l.toReadable,control:p,items:l.toArray(),title:"Filter"}),e.jsx(G,{name:"sorting",control:p,title:"Sorting",toReadable:c.toReadable}),e.jsx(k,{type:"submit",children:"Apply"})]})}),e.jsxs("aside",{className:h.aside,children:[e.jsx($,{onClick:o,children:e.jsx(H,{})}),e.jsx(K,{lastItemNode:I,onObserve:C,children:e.jsxs(e.Fragment,{children:[i&&n.length===0&&e.jsx(v,{}),n.map((t,r)=>e.jsxs(g,{children:[e.jsx(ne,{ref:r===n.length-1?_:null,anime:t}),e.jsx(W,{})]},t.id))]})})]}),e.jsx(V,{})]})},pe=a.memo(oe);export{pe as AnimePage};
