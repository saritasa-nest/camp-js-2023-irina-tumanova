import{r as t,u as A,j as a,D as P,A as m,a as g,B as F,c as w,b as j,L as I,d as D,e as R,T as h,f,g as M,h as _,i as k,k as E,O}from"./index-49fa4153.js";import{P as S,M as T,a as B,I as W,D as q}from"./InfinityScroll-8b466525.js";import{u as $,T as z,I as V}from"./index.esm-762ffa40.js";import{M as J}from"./MultipleSelect-be0d4bc0.js";class b{constructor({types:s,search:n}){this.types=s,this.search=n}}var u=(e=>(e.ChangePagination="change_pagination",e.ChangeSorting="change_sorting",e.ChangeFilter="change_filter",e.ChangeFilterAndSorting="change_filter_and_sorting",e))(u||{});const U=(e,s)=>{switch(s.type){case"change_pagination":return{...e,pagination:new S({...e.pagination,pageNumber:e.pagination.pageNumber+1})};case"change_sorting":return{...e,pagination:s.payload.defaultPagination,sorting:s.payload.sorting};case"change_filter":return{...e,pagination:s.payload.defaultPagination,filters:s.payload.filters};case"change_filter_and_sorting":return{...e,pagination:s.payload.defaultPagination,filters:s.payload.filters,sorting:s.payload.sorting};default:return e}},G="_pageWrapper_fzkaq_1",H={pageWrapper:G},K="_form_1pkbk_1",Q={form:K},X=({isOpened:e,toggleMenu:s,paramsDispatch:n,defaultFormValues:o,defaultParams:l})=>{const r=A(),{register:c,handleSubmit:p,control:i}=$({defaultValues:o}),d=({types:L,search:v,sorting:N})=>{r(w()),n({type:u.ChangeFilterAndSorting,payload:{sorting:N,defaultPagination:l.pagination,filters:new b({types:L,search:v})}}),s()};return a.jsx(P,{open:e,onClose:s,children:a.jsxs("form",{className:Q.form,onSubmit:p(d),children:[a.jsx(z,{label:"Search",...c("search")}),a.jsx(J,{name:"types",toReadable:m.toReadable,control:i,items:m.toArray(),title:"Filter"}),a.jsx(T,{name:"sorting",control:i,title:"Sorting",toReadable:g.toReadable}),a.jsx(F,{type:"submit",children:"Apply"})]})})},Y=t.memo(X),Z=j(e=>e.anime.anime,e=>e),ee=j(e=>e.anime.isLoading,e=>e),ae="_aside_i7p1g_1",se={aside:ae},te="_animeCard_hvndq_1",ne="_animeAvatar_hvndq_12",x={animeCard:te,animeAvatar:ne},ie=t.forwardRef(({anime:e},s)=>a.jsxs(I,{ref:s,className:x.animeCard,children:[a.jsx(D,{className:x.animeAvatar,src:e.imageUrl}),a.jsx(R,{primary:a.jsxs(h,{component:"h4",variant:"body2",children:[e.titleJapanese,a.jsx("br",{}),e.titleEnglish]}),secondary:a.jsxs(h,{component:"span",variant:"body2",children:["Type: ",m.toReadable(e.type),a.jsx("br",{}),"Status: ",e.status]})})]})),re=t.memo(ie),oe=({toggleMenu:e,paramsDispatch:s})=>{const n=f(Z),o=f(ee),[l,r]=t.useState(null),c=()=>{s({type:u.ChangePagination})},p=t.useCallback(i=>{r(i)},[]);return a.jsxs("aside",{className:se.aside,children:[o&&n.length===0&&a.jsx(M,{}),a.jsx(V,{onClick:e,children:a.jsx(B,{})}),a.jsx(W,{lastItemNode:l,onObserve:c,children:a.jsx(a.Fragment,{children:n.map((i,d)=>a.jsxs(_,{children:[a.jsx(re,{ref:d===n.length-1?p:null,anime:i}),a.jsx(q,{})]},i.id))})})]})},le=t.memo(oe),C=[{field:g.TitleEnglish,direction:""},{field:g.Status,direction:""}],y={pagination:new S({pageSize:15,pageNumber:0}),sorting:C,filters:new b({types:[],search:""})},ce={types:[],search:"",sorting:C},pe=()=>{const e=A(),[s,n]=t.useReducer(U,y);t.useEffect(()=>{e(k())},[]),t.useEffect(()=>{e(E(s))},[s]);const[o,l]=t.useState(!1),r=()=>{l(c=>!c)};return a.jsxs(_,{className:H.pageWrapper,children:[a.jsx(Y,{paramsDispatch:n,toggleMenu:r,isOpened:o,defaultFormValues:ce,defaultParams:y}),a.jsx(le,{paramsDispatch:n,toggleMenu:r}),a.jsx(O,{})]})},he=t.memo(pe);export{he as AnimePage};
