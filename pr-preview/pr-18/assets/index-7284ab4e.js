import{r as t,u as A,j as a,D as N,A as m,a as g,B as P,c as F,b as j,L as I,d as w,e as D,T as h,f,g as R,h as _,i as M,k,O as E}from"./index-d5034332.js";import{M as O,a as T,I as B,D as W,P as q}from"./InfinityScroll-255eaa02.js";import{u as $,T as z,I as V}from"./index.esm-5f863f4f.js";import{M as J}from"./MultipleSelect-caaa492b.js";class S{constructor({types:s,search:n}){this.types=s,this.search=n}}var u=(e=>(e.ChangePagination="change_pagination",e.ChangeSorting="change_sorting",e.ChangeFilter="change_filter",e.ChangeFilterAndSorting="change_filter_and_sorting",e))(u||{});const U=(e,s)=>{switch(s.type){case"change_pagination":return{...e,pagination:{...e.pagination,pageNumber:e.pagination.pageNumber+1}};case"change_sorting":return{...e,pagination:s.payload.defaultPagination,sorting:s.payload.sorting};case"change_filter":return{...e,pagination:s.payload.defaultPagination,filters:s.payload.filters};case"change_filter_and_sorting":return{...e,pagination:s.payload.defaultPagination,filters:s.payload.filters,sorting:s.payload.sorting};default:return e}},G="_pageWrapper_fzkaq_1",H={pageWrapper:G},K="_form_1pkbk_1",Q={form:K},X=({isOpened:e,toggleMenu:s,paramsDispatch:n,defaultFormValues:o,defaultParams:l})=>{const r=A(),{register:c,handleSubmit:p,control:i}=$({defaultValues:o}),d=({types:C,search:L,sorting:v})=>{r(F()),n({type:u.ChangeFilterAndSorting,payload:{sorting:v,defaultPagination:l.pagination,filters:new S({types:C,search:L})}}),s()};return a.jsx(N,{open:e,onClose:s,children:a.jsxs("form",{className:Q.form,onSubmit:p(d),children:[a.jsx(z,{label:"Search",...c("search")}),a.jsx(J,{name:"types",toReadable:m.toReadable,control:i,items:m.toArray(),title:"Filter"}),a.jsx(O,{name:"sorting",control:i,title:"Sorting",toReadable:g.toReadable}),a.jsx(P,{type:"submit",children:"Apply"})]})})},Y=t.memo(X),Z=j(e=>e.anime.anime,e=>e),ee=j(e=>e.anime.isLoading,e=>e),ae="_aside_i7p1g_1",se={aside:ae},te="_animeCard_hvndq_1",ne="_animeAvatar_hvndq_12",x={animeCard:te,animeAvatar:ne},ie=t.forwardRef(({anime:e},s)=>a.jsxs(I,{ref:s,className:x.animeCard,children:[a.jsx(w,{className:x.animeAvatar,src:e.imageUrl}),a.jsx(D,{primary:a.jsxs(h,{component:"h4",variant:"body2",children:[e.titleJapanese,a.jsx("br",{}),e.titleEnglish]}),secondary:a.jsxs(h,{component:"span",variant:"body2",children:["Type: ",m.toReadable(e.type),a.jsx("br",{}),"Status: ",e.status]})})]})),re=t.memo(ie),oe=({toggleMenu:e,paramsDispatch:s})=>{const n=f(Z),o=f(ee),[l,r]=t.useState(null),c=()=>{s({type:u.ChangePagination})},p=t.useCallback(i=>{r(i)},[]);return a.jsxs("aside",{className:se.aside,children:[o&&n.length===0&&a.jsx(R,{}),a.jsx(V,{onClick:e,children:a.jsx(T,{})}),a.jsx(B,{lastItemNode:l,onObserve:c,children:a.jsx(a.Fragment,{children:n.map((i,d)=>a.jsxs(_,{children:[a.jsx(re,{ref:d===n.length-1?p:null,anime:i}),a.jsx(W,{})]},i.id))})})]})},le=t.memo(oe),b=[{field:g.TitleEnglish,direction:""},{field:g.Status,direction:""}],y={pagination:new q({pageSize:15,pageNumber:0}),sorting:b,filters:new S({types:[],search:""})},ce={types:[],search:"",sorting:b},pe=()=>{const e=A(),[s,n]=t.useReducer(U,y);t.useEffect(()=>{e(M())},[]),t.useEffect(()=>{e(k(s))},[s]);const[o,l]=t.useState(!1),r=()=>{l(c=>!c)};return a.jsxs(_,{className:H.pageWrapper,children:[a.jsx(Y,{paramsDispatch:n,toggleMenu:r,isOpened:o,defaultFormValues:ce,defaultParams:y}),a.jsx(le,{paramsDispatch:n,toggleMenu:r}),a.jsx(E,{})]})},he=t.memo(pe);export{he as AnimePage};
