"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[116],{7116:(it,_,i)=>{i.r(_),i.d(_,{AuthModule:()=>at});var h,l=i(89),d=i(2074),E=i(2355),m=i(2369),a=i(6652),f=i(1300),x=i(2151),c=i(6789),P=i(4926),t=i(4355),w=i(5081),g=i(4121),Z=i(9676),v=i(8168),C=i(3568),T=i(4945),I=i(5490),J=i(9787);class F{constructor({attr:o,code:r,detail:n}){this.attr=o,this.code=r,this.detail=n}}(h||(h={})).fromDto=function o(r){return new F({attr:r.attr,code:r.code,detail:r.detail})};var b=i(6738);let N=(()=>{class e{getErrors(r){return r instanceof b.UA&&r.error.errors instanceof Array?r.error.errors.map(n=>h.fromDto(n)):[]}showErrorsToForm(r,n){r.forEach(s=>{null!==s.attr&&s.attr in n.controls&&n.controls[s.attr].setErrors({...n.controls[s.attr].errors,[s.code]:s.detail})})}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u,e;(e=u||(u={})).MIN_PASSWORD_LENGTH=8,e.passwordRepetition=function o(){return r=>{if(r instanceof a.cw){const{password:n,repeatedPassword:s}=r.controls;if(s.value.length<e.MIN_PASSWORD_LENGTH)return null;s.setErrors(n.value!==s.value?{passwordDoesNotMatch:!0}:null)}return null}};var y=i(8598);let U=(()=>{class e{transform(r){return`${r[0].toUpperCase()}${r.slice(1).toLowerCase()}`}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=t.Yjl({name:"sentensecase",type:e,pure:!1}),e})();function M(e,o){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.hij("Please enter ",r.fieldName,"")}}function L(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Min 8 characters"),t.qZA())}function Q(e,o){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const r=o.ngIf;t.xp6(1),t.Oqu(r)}}function R(e,o){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"sentensecase"),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.hij("",t.lcZ(2,1,r.fieldName)," doesn't match")}}function O(e,o){if(1&e){const r=t.EpF();t.TgZ(0,"mat-form-field",1)(1,"mat-label"),t._uU(2),t.ALo(3,"sentensecase"),t.qZA(),t._UZ(4,"input",2),t.TgZ(5,"button",3),t.NdJ("click",function(){t.CHM(r);const s=t.oxw();return t.KtG(s.changePasswordVisibility())}),t.TgZ(6,"mat-icon"),t._uU(7),t.qZA()(),t.YNc(8,M,2,1,"mat-error",4),t.YNc(9,L,2,0,"mat-error",4),t.YNc(10,Q,2,1,"mat-error",4),t.YNc(11,R,3,3,"mat-error",4),t.qZA()}if(2&e){const r=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,10,r.fieldName)),t.xp6(2),t.Q6J("formControl",r.control)("type",r.shouldPasswordBeHidden?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",r.shouldPasswordBeHidden),t.xp6(2),t.Oqu(r.shouldPasswordBeHidden?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",r.control.hasError("required")),t.xp6(1),t.Q6J("ngIf",r.control.hasError("minlength")),t.xp6(1),t.Q6J("ngIf",r.control.getError("password_too_common")),t.xp6(1),t.Q6J("ngIf",r.control.hasError("passwordDoesNotMatch"))}}let S=(()=>{class e{constructor(){this.shouldPasswordBeHidden=!0,this.control=null,this.fieldName=null}changePasswordVisibility(){this.shouldPasswordBeHidden=!this.shouldPasswordBeHidden}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-password-field"]],inputs:{control:"control",fieldName:"fieldName"},decls:1,vars:1,consts:[["class","password-field",4,"ngIf"],[1,"password-field"],["matInput","","autocomplete","current-password",3,"formControl","type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[4,"ngIf"]],template:function(r,n){1&r&&t.YNc(0,O,12,12,"mat-form-field",0),2&r&&t.Q6J("ngIf",n.control&&n.fieldName)},dependencies:[l.O5,a.Fj,a.JJ,a.oH,m.KE,m.hX,m.TO,m.R9,d.Nt,f.RK,x.Hw,U],styles:[".password-field[_ngcontent-%COMP%]{width:100%}"]}),e})();function q(e,o){if(1&e&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&e){const r=o.$implicit;t.xp6(1),t.hij(" ",r.detail," ")}}function Y(e,o){if(1&e&&(t.ynx(0),t.YNc(1,q,2,1,"p",6),t.BQk()),2&e){const r=o.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",r)("ngForTrackBy",n.trackErrorByCode)}}function B(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter email"),t.qZA())}function H(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email"),t.qZA())}function D(e,o){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email"),t.qZA(),t._UZ(3,"input",8),t.YNc(4,B,2,0,"mat-error",2),t.YNc(5,H,2,0,"mat-error",2),t.qZA()),2&e){const r=o.ngIf;t.xp6(3),t.Q6J("formControl",r),t.xp6(1),t.Q6J("ngIf",r.hasError("required")),t.xp6(1),t.Q6J("ngIf",r.hasError("email"))}}function j(e,o){1&e&&t._UZ(0,"camp-shadow-spinner")}let $=(()=>{class e{constructor(){this.isSubmitting$=new g.X(!1),this.loginErrors$=new g.X([]),this.formBuilder=(0,t.f3M)(a.j3),this.authService=(0,t.f3M)(w.e),this.errorService=(0,t.f3M)(N),this.router=(0,t.f3M)(c.F0),this.untilDestroyed=(0,J.t)(),this.form=this.createForm()}ngOnInit(){this.form.valueChanges.pipe(this.untilDestroyed()).subscribe(()=>this.loginErrors$.next([]))}handleSubmit(){"VALID"===this.form.status&&(this.isSubmitting$.next(!0),this.authService.login(this.form.getRawValue()).pipe((0,Z.P)(),(0,v.b)(()=>this.router.navigate(["anime"])),(0,C.K)(r=>(0,T.of)(this.handleError(r))),(0,I.x)(()=>this.isSubmitting$.next(!1))).subscribe())}createForm(){return this.formBuilder.group({email:["",[a.kI.required,a.kI.email]],password:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]]})}handleError(r){this.loginErrors$.next(this.errorService.getErrors(r))}trackErrorByCode(r,n){return n.code}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-login-page"]],decls:13,vars:9,consts:[[1,"typography-title"],[1,"auth-form",3,"formGroup","ngSubmit"],[4,"ngIf"],["fieldName","password",3,"control"],["type","submit","mat-raised-button","","color","primary",1,"auth-form__submit-button"],["routerLink","/auth/signup","mat-button",""],["class","auth-form__error",4,"ngFor","ngForOf","ngForTrackBy"],[1,"auth-form__error"],["matInput","","placeholder","example@gmail.com","autocomplete","email",3,"formControl"]],template:function(r,n){1&r&&(t.TgZ(0,"p",0),t._uU(1,"Sign in"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return n.handleSubmit()}),t.YNc(3,Y,2,2,"ng-container",2),t.ALo(4,"async"),t.YNc(5,D,6,3,"mat-form-field",2),t._UZ(6,"camp-password-field",3),t.TgZ(7,"button",4),t._uU(8,"Sign in"),t.qZA()(),t.TgZ(9,"a",5),t._uU(10,"Sign up"),t.qZA(),t.YNc(11,j,1,0,"camp-shadow-spinner",2),t.ALo(12,"async")),2&r&&(t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,5,n.loginErrors$)),t.xp6(2),t.Q6J("ngIf",n.form.controls.email),t.xp6(1),t.Q6J("control",n.form.controls.password),t.xp6(5),t.Q6J("ngIf",t.lcZ(12,7,n.isSubmitting$)))},dependencies:[l.sg,l.O5,y.e,c.rH,a._Y,a.Fj,a.JJ,a.JL,a.oH,a.sg,m.KE,m.hX,m.TO,d.Nt,f.zs,f.lW,S,l.Ov],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-m);padding:var(--space-m)}.auth-form[_ngcontent-%COMP%]{display:flex;max-width:var(--auth-form-max-width);width:100%;flex-direction:column;gap:var(--space-s);justify-content:center}.auth-form__error[_ngcontent-%COMP%]{color:var(--primary-color);align-self:center}.auth-form__submit-button[_ngcontent-%COMP%]{align-self:center}"],changeDetection:0}),e})();function G(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter email"),t.qZA())}function X(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email"),t.qZA())}function k(e,o){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const r=o.ngIf;t.xp6(1),t.Oqu(r)}}function V(e,o){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email"),t.qZA(),t._UZ(3,"input",7),t.YNc(4,G,2,0,"mat-error",2),t.YNc(5,X,2,0,"mat-error",2),t.YNc(6,k,2,1,"mat-error",2),t.qZA()),2&e){const r=o.ngIf;t.xp6(3),t.Q6J("formControl",r),t.xp6(1),t.Q6J("ngIf",r.hasError("required")),t.xp6(1),t.Q6J("ngIf",r.hasError("email")),t.xp6(1),t.Q6J("ngIf",r.getError("unique"))}}function z(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter first name"),t.qZA())}function K(e,o){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"First name"),t.qZA(),t._UZ(3,"input",8),t.YNc(4,z,2,0,"mat-error",2),t.qZA()),2&e){const r=o.ngIf;t.xp6(3),t.Q6J("formControl",r),t.xp6(1),t.Q6J("ngIf",r.hasError("required"))}}function W(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter last name"),t.qZA())}function tt(e,o){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Last name"),t.qZA(),t._UZ(3,"input",9),t.YNc(4,W,2,0,"mat-error",2),t.qZA()),2&e){const r=o.ngIf;t.xp6(3),t.Q6J("formControl",r),t.xp6(1),t.Q6J("ngIf",r.hasError("required"))}}function et(e,o){1&e&&t._UZ(0,"camp-shadow-spinner")}let rt=(()=>{class e{constructor(){this.isSubmitting$=new g.X(!1),this.formBuilder=(0,t.f3M)(a.j3),this.authService=(0,t.f3M)(w.e),this.errorService=(0,t.f3M)(N),this.router=(0,t.f3M)(c.F0),this.changeDetectorRef=(0,t.f3M)(t.sBO),this.form=this.createForm()}handleSubmit(){"VALID"===this.form.status&&(this.isSubmitting$.next(!0),this.authService.register(this.form.getRawValue()).pipe((0,Z.P)(),(0,v.b)(()=>this.router.navigate(["anime"])),(0,C.K)(r=>(0,T.of)(this.handleError(r))),(0,I.x)(()=>this.isSubmitting$.next(!1))).subscribe())}handleError(r){const n=this.errorService.getErrors(r);this.errorService.showErrorsToForm(n,this.form),this.changeDetectorRef.markForCheck()}createForm(){return this.formBuilder.group({email:["",[a.kI.required,a.kI.email]],firstName:["",[a.kI.required]],lastName:["",[a.kI.required]],password:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]],repeatedPassword:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]]},{validators:[u.passwordRepetition()]})}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-register-page"]],decls:14,vars:9,consts:[[1,"typography-title"],[1,"auth-form",3,"formGroup","ngSubmit"],[4,"ngIf"],["fieldName","password",3,"control"],["fieldName","repeated password",3,"control"],["type","submit","mat-raised-button","","color","primary",1,"auth-form__submit-button"],["routerLink","/auth/signin","mat-button",""],["matInput","","placeholder","example@gmail.com","autocomplete","email",3,"formControl"],["matInput","","placeholder","John","autocomplete","given-name",3,"formControl"],["matInput","","placeholder","Doe","autocomplete","family-name",3,"formControl"]],template:function(r,n){1&r&&(t.TgZ(0,"p",0),t._uU(1,"Sign up"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return n.handleSubmit()}),t.YNc(3,V,7,4,"mat-form-field",2),t.YNc(4,K,5,2,"mat-form-field",2),t.YNc(5,tt,5,2,"mat-form-field",2),t._UZ(6,"camp-password-field",3)(7,"camp-password-field",4),t.TgZ(8,"button",5),t._uU(9,"Sign up"),t.qZA()(),t.TgZ(10,"a",6),t._uU(11,"Sign in"),t.qZA(),t.YNc(12,et,1,0,"camp-shadow-spinner",2),t.ALo(13,"async")),2&r&&(t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.email),t.xp6(1),t.Q6J("ngIf",n.form.controls.firstName),t.xp6(1),t.Q6J("ngIf",n.form.controls.lastName),t.xp6(1),t.Q6J("control",n.form.controls.password),t.xp6(1),t.Q6J("control",n.form.controls.repeatedPassword),t.xp6(5),t.Q6J("ngIf",t.lcZ(13,7,n.isSubmitting$)))},dependencies:[l.O5,y.e,c.rH,a._Y,a.Fj,a.JJ,a.JL,a.oH,a.sg,m.KE,m.hX,m.TO,d.Nt,f.zs,f.lW,S,l.Ov],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-m);padding:var(--space-m)}.auth-form[_ngcontent-%COMP%]{display:flex;max-width:var(--auth-form-max-width);width:100%;flex-direction:column;gap:var(--space-s);justify-content:center}.auth-form__error[_ngcontent-%COMP%]{color:var(--primary-color);align-self:center}.auth-form__submit-button[_ngcontent-%COMP%]{align-self:center}"],changeDetection:0}),e})();const ot=[{path:"",redirectTo:"signin",pathMatch:"prefix"},{path:"signin",title:"Sign In",component:$,canActivate:[P.e]},{path:"signup",title:"Sign Up",component:rt,canActivate:[P.e]}];let nt=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.Bz.forChild(ot),c.Bz]}),e})(),at=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:m.o2,useValue:{appearance:"outline"}}],imports:[l.ez,E.m,nt,a.u5,a.UX,m.lN,d.c,f.ot,x.Ps]}),e})()}}]);