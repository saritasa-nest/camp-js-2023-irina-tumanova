"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[563],{8563:(pt,Z,i)=>{i.r(Z),i.d(Z,{AuthModule:()=>ct});var u,e,l=i(89),g=i(2074),E=i(2355),m=i(2369),a=i(6652),f=i(1300),C=i(2151),c=i(6789),w=i(4926),t=i(4355),T=i(5081),h=i(4121),v=i(9676),p=i(8168),N=i(5490),J=i(2522);(e=u||(u={})).MIN_PASSWORD_LENGTH=8,e.passwordRepetition=function r(){return o=>{if(o instanceof a.cw){const{password:n,repeatedPassword:s}=o.controls;if(s.value.length<e.MIN_PASSWORD_LENGTH)return null;s.setErrors(n.value!==s.value?{passwordDoesNotMatch:!0}:null)}return null}};var b=i(3568),U=i(4945),F=i(3787);const P="common",R={[P]:[]};class M{constructor({code:r,detail:o}){this.code=r,this.detail=o}}var x;!function(e){e.fromDto=function r(o){const n={common:[]};return o.forEach(s=>{const _=new M({code:s.code,detail:s.detail});n[null===s.attr?P:s.attr]=[...n[P],_]}),n}}(x||(x={}));var O=i(6738);function I(){return function(e){return e.pipe((0,b.K)(r=>r instanceof O.UA&&r.error.errors instanceof Array?(0,U.of)(x.fromDto(r.error.errors)):(0,F._)(()=>r)))}}var A=i(8598);let L=(()=>{class e{transform(o){return`${o[0].toUpperCase()}${o.slice(1).toLowerCase()}`}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275pipe=t.Yjl({name:"sentensecase",type:e,pure:!1}),e})();function Q(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.hij("Please enter ",o.fieldName,"")}}function q(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Min 8 characters"),t.qZA())}function Y(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const o=r.ngIf;t.xp6(1),t.Oqu(o)}}function B(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"sentensecase"),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.hij("",t.lcZ(2,1,o.fieldName)," doesn't match")}}function D(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-form-field",1)(1,"mat-label"),t._uU(2),t.ALo(3,"sentensecase"),t.qZA(),t._UZ(4,"input",2),t.TgZ(5,"button",3),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.changePasswordVisibility())}),t.TgZ(6,"mat-icon"),t._uU(7),t.qZA()(),t.YNc(8,Q,2,1,"mat-error",4),t.YNc(9,q,2,0,"mat-error",4),t.YNc(10,Y,2,1,"mat-error",4),t.YNc(11,B,3,3,"mat-error",4),t.qZA()}if(2&e){const o=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,10,o.fieldName)),t.xp6(2),t.Q6J("formControl",o.control)("type",o.shouldPasswordBeHidden?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",o.shouldPasswordBeHidden),t.xp6(2),t.Oqu(o.shouldPasswordBeHidden?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",o.control.hasError("required")),t.xp6(1),t.Q6J("ngIf",o.control.hasError("minlength")),t.xp6(1),t.Q6J("ngIf",o.control.getError("password_too_common")),t.xp6(1),t.Q6J("ngIf",o.control.hasError("passwordDoesNotMatch"))}}let y=(()=>{class e{constructor(){this.shouldPasswordBeHidden=!0,this.control=null,this.fieldName=null}changePasswordVisibility(){this.shouldPasswordBeHidden=!this.shouldPasswordBeHidden}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-password-field"]],inputs:{control:"control",fieldName:"fieldName"},decls:1,vars:1,consts:[["class","password-field",4,"ngIf"],[1,"password-field"],["matInput","","autocomplete","current-password",3,"formControl","type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[4,"ngIf"]],template:function(o,n){1&o&&t.YNc(0,D,12,12,"mat-form-field",0),2&o&&t.Q6J("ngIf",n.control&&n.fieldName)},dependencies:[l.O5,a.Fj,a.JJ,a.oH,m.KE,m.hX,m.TO,m.R9,g.Nt,f.RK,C.Hw,L],styles:[".password-field[_ngcontent-%COMP%]{width:100%}"]}),e})();function H(e,r){if(1&e&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",o.detail," ")}}function j(e,r){if(1&e&&(t.ynx(0),t.YNc(1,H,2,1,"p",6),t.BQk()),2&e){const o=r.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.common)("ngForTrackBy",n.trackErrorByCode)}}function $(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter email"),t.qZA())}function G(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email"),t.qZA())}function X(e,r){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email"),t.qZA(),t._UZ(3,"input",8),t.YNc(4,$,2,0,"mat-error",2),t.YNc(5,G,2,0,"mat-error",2),t.qZA()),2&e){const o=r.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngIf",o.hasError("email"))}}function K(e,r){1&e&&t._UZ(0,"camp-shadow-spinner")}let V=(()=>{class e{constructor(){this.isSubmitting$=new h.X(!1),this.loginErrors$=new h.X(null),this.formBuilder=(0,t.f3M)(a.j3),this.authService=(0,t.f3M)(T.e),this.router=(0,t.f3M)(c.F0),this.untilDestroyed=(0,J.t)(),this.form=this.createForm()}ngOnInit(){this.form.valueChanges.pipe(this.untilDestroyed()).subscribe(()=>this.loginErrors$.next(null))}handleSubmit(){"VALID"===this.form.status&&(this.isSubmitting$.next(!0),this.authService.login(this.form.getRawValue()).pipe((0,v.P)(),(0,p.b)(()=>this.router.navigate(["anime"])),I(),(0,p.b)(o=>this.loginErrors$.next(o??null)),(0,N.x)(()=>this.isSubmitting$.next(!1))).subscribe())}createForm(){return this.formBuilder.group({email:["",[a.kI.required,a.kI.email]],password:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]]})}trackErrorByCode(o,n){return n.code}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-login-page"]],decls:13,vars:9,consts:[[1,"typography-title"],[1,"auth-form",3,"formGroup","ngSubmit"],[4,"ngIf"],["fieldName","password",3,"control"],["type","submit","mat-raised-button","","color","primary",1,"auth-form__submit-button"],["routerLink","/auth/signup","mat-button",""],["class","auth-form__error",4,"ngFor","ngForOf","ngForTrackBy"],[1,"auth-form__error"],["matInput","","placeholder","example@gmail.com","autocomplete","email",3,"formControl"]],template:function(o,n){1&o&&(t.TgZ(0,"p",0),t._uU(1,"Sign in"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return n.handleSubmit()}),t.YNc(3,j,2,2,"ng-container",2),t.ALo(4,"async"),t.YNc(5,X,6,3,"mat-form-field",2),t._UZ(6,"camp-password-field",3),t.TgZ(7,"button",4),t._uU(8,"Sign in"),t.qZA()(),t.TgZ(9,"a",5),t._uU(10,"Sign up"),t.qZA(),t.YNc(11,K,1,0,"camp-shadow-spinner",2),t.ALo(12,"async")),2&o&&(t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,5,n.loginErrors$)),t.xp6(2),t.Q6J("ngIf",n.form.controls.email),t.xp6(1),t.Q6J("control",n.form.controls.password),t.xp6(5),t.Q6J("ngIf",t.lcZ(12,7,n.isSubmitting$)))},dependencies:[l.sg,l.O5,A.e,c.rH,a._Y,a.Fj,a.JJ,a.JL,a.oH,a.sg,m.KE,m.hX,m.TO,g.Nt,f.zs,f.lW,y,l.Ov],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-m);padding:var(--space-m)}.auth-form[_ngcontent-%COMP%]{display:flex;max-width:var(--auth-form-max-width);width:100%;flex-direction:column;gap:var(--space-s);justify-content:center}.auth-form__error[_ngcontent-%COMP%]{color:var(--primary-color);align-self:center}.auth-form__submit-button[_ngcontent-%COMP%]{align-self:center}"],changeDetection:0}),e})();var W=i(7969);function k(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter email"),t.qZA())}function tt(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email"),t.qZA())}function et(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const o=r.ngIf;t.xp6(1),t.Oqu(o)}}function ot(e,r){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email"),t.qZA(),t._UZ(3,"input",7),t.YNc(4,k,2,0,"mat-error",2),t.YNc(5,tt,2,0,"mat-error",2),t.YNc(6,et,2,1,"mat-error",2),t.qZA()),2&e){const o=r.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngIf",o.hasError("email")),t.xp6(1),t.Q6J("ngIf",o.getError("unique"))}}function rt(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter first name"),t.qZA())}function nt(e,r){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"First name"),t.qZA(),t._UZ(3,"input",8),t.YNc(4,rt,2,0,"mat-error",2),t.qZA()),2&e){const o=r.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required"))}}function at(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter last name"),t.qZA())}function it(e,r){if(1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Last name"),t.qZA(),t._UZ(3,"input",9),t.YNc(4,at,2,0,"mat-error",2),t.qZA()),2&e){const o=r.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required"))}}function st(e,r){1&e&&t._UZ(0,"camp-shadow-spinner")}let mt=(()=>{class e{constructor(){this.isSubmitting$=new h.X(!1),this.formBuilder=(0,t.f3M)(a.j3),this.authService=(0,t.f3M)(T.e),this.router=(0,t.f3M)(c.F0),this.changeDetectorRef=(0,t.f3M)(t.sBO),this.form=this.createForm()}handleSubmit(){"VALID"===this.form.status&&(this.isSubmitting$.next(!0),this.authService.register(this.form.getRawValue()).pipe((0,v.P)(),(0,p.b)(()=>this.router.navigate(["anime"])),I(),(0,W.U)(o=>o??R),function z(e){return function(r){return r.pipe((0,p.b)(o=>{Object.keys(o).map(n=>{if(void 0!==e.controls[n]){const s={};o[n].forEach(_=>{s[_.code]=_.detail}),e.controls[n].setErrors(s)}})}))}}(this.form),(0,p.b)(()=>this.changeDetectorRef.markForCheck()),(0,N.x)(()=>this.isSubmitting$.next(!1))).subscribe())}createForm(){return this.formBuilder.group({email:["",[a.kI.required,a.kI.email]],firstName:["",[a.kI.required]],lastName:["",[a.kI.required]],password:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]],repeatedPassword:["",[a.kI.required,a.kI.minLength(u.MIN_PASSWORD_LENGTH)]]},{validators:[u.passwordRepetition()]})}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-register-page"]],decls:14,vars:9,consts:[[1,"typography-title"],[1,"auth-form",3,"formGroup","ngSubmit"],[4,"ngIf"],["fieldName","password",3,"control"],["fieldName","repeated password",3,"control"],["type","submit","mat-raised-button","","color","primary",1,"auth-form__submit-button"],["routerLink","/auth/signin","mat-button",""],["matInput","","placeholder","example@gmail.com","autocomplete","email",3,"formControl"],["matInput","","placeholder","John","autocomplete","given-name",3,"formControl"],["matInput","","placeholder","Doe","autocomplete","family-name",3,"formControl"]],template:function(o,n){1&o&&(t.TgZ(0,"p",0),t._uU(1,"Sign up"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return n.handleSubmit()}),t.YNc(3,ot,7,4,"mat-form-field",2),t.YNc(4,nt,5,2,"mat-form-field",2),t.YNc(5,it,5,2,"mat-form-field",2),t._UZ(6,"camp-password-field",3)(7,"camp-password-field",4),t.TgZ(8,"button",5),t._uU(9,"Sign up"),t.qZA()(),t.TgZ(10,"a",6),t._uU(11,"Sign in"),t.qZA(),t.YNc(12,st,1,0,"camp-shadow-spinner",2),t.ALo(13,"async")),2&o&&(t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.email),t.xp6(1),t.Q6J("ngIf",n.form.controls.firstName),t.xp6(1),t.Q6J("ngIf",n.form.controls.lastName),t.xp6(1),t.Q6J("control",n.form.controls.password),t.xp6(1),t.Q6J("control",n.form.controls.repeatedPassword),t.xp6(5),t.Q6J("ngIf",t.lcZ(13,7,n.isSubmitting$)))},dependencies:[l.O5,A.e,c.rH,a._Y,a.Fj,a.JJ,a.JL,a.oH,a.sg,m.KE,m.hX,m.TO,g.Nt,f.zs,f.lW,y,l.Ov],styles:["[_nghost-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-m);padding:var(--space-m)}.auth-form[_ngcontent-%COMP%]{display:flex;max-width:var(--auth-form-max-width);width:100%;flex-direction:column;gap:var(--space-s);justify-content:center}.auth-form__error[_ngcontent-%COMP%]{color:var(--primary-color);align-self:center}.auth-form__submit-button[_ngcontent-%COMP%]{align-self:center}"],changeDetection:0}),e})();const lt=[{path:"",redirectTo:"signin",pathMatch:"prefix"},{path:"signin",title:"Sign In",component:V,canActivate:[w.e]},{path:"signup",title:"Sign Up",component:mt,canActivate:[w.e]}];let ft=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.Bz.forChild(lt),c.Bz]}),e})(),ct=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:m.o2,useValue:{appearance:"outline"}}],imports:[l.ez,E.m,ft,a.u5,a.UX,m.lN,g.c,f.ot,C.Ps]}),e})()}}]);