import{b as _,j as e,d as b,r as n,e as p,L as D,g as F,u as y,h as u,s as R,i as T,k as E,T as O,G as f,l as A,m as x,n as k,o as z,D as B,B as H,p as V,q as $,O as q,t as Y}from"./index-2ee20234.js";import{u as J,T as K}from"./index.esm-563c1879.js";import{M as Q,a as U,P as W}from"./MultipleSelect-14d40464.js";import{I as X}from"./IconButton-dc93c6ef.js";import"./GlobalStyles-fcf59265.js";import"./listItemIconClasses-d24ce45f.js";const Z=_(e.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu"),ee=b(s=>s.genres.genres,s=>s),se=b(s=>s.genres.isLoading,s=>s),te=(s,t,r)=>{n.useEffect(()=>{if(s&&t){const c={root:s,threshold:0},o=new IntersectionObserver(i=>{i.every(l=>l.isIntersecting)&&r()},c);return o.observe(t),()=>{o.disconnect()}}},[s,t])},ne=({lastItemNode:s,onObserve:t,children:r})=>{const[c,o]=n.useState(null);te(c,s,t);const i=n.useCallback(l=>{o(l)},[]);return e.jsx(p,{sx:{position:"relative",flex:1,display:"flex",width:"100%"},children:e.jsx(D,{ref:i,sx:{overflowY:"auto",position:"absolute",inset:0},children:r})})},ae=n.memo(ne);class S{constructor({types:t,search:r}){this.types=t,this.search=r}}const re={"card-container":"_card-container_16fj8_1"},oe=n.forwardRef(({genre:s},t)=>{const r=F(),c=y(),o=u(R),i=()=>{o&&c(A()),r(`${s.id}`)};return e.jsx(T,{className:re["card-container"],ref:t,onClick:i,children:e.jsx(E,{primary:s.name,secondary:e.jsx(O,{component:"span",variant:"body2",color:"text.primary",children:f.toReadable(s.type)})})})}),ie=n.memo(oe),ce="_aside_138wd_1",le="_form_138wd_10",g={aside:ce,form:le},v=[{field:x.Name,direction:""},{field:x.Type,direction:""}],j={pagination:new W({pageSize:15,pageNumber:0}),sorting:v,filters:new S({types:[],search:""})},de={types:[],search:"",sorting:v},me=()=>{const s=y(),t=u(ee),r=u(se),[c,o]=n.useState(!1),[i,l]=n.useState(j),[G,I]=n.useState(null),N=()=>{l(a=>({...a,pagination:{...a.pagination,pageNumber:a.pagination.pageNumber+1}}))};n.useEffect(()=>{s(k())},[]),n.useEffect(()=>{s(z(i))},[i]);const{register:w,handleSubmit:C,control:h}=J({defaultValues:de}),d=()=>{o(a=>!a)},L=({types:a,search:m,sorting:P})=>{s(Y()),l({...j,sorting:P,filters:new S({types:a,search:m})}),d()},M=n.useCallback(a=>{I(a)},[]);return e.jsxs(p,{sx:{flex:1,display:"flex"},children:[e.jsx(B,{open:c,onClose:d,children:e.jsxs("form",{className:g.form,onSubmit:C(L),children:[e.jsx(K,{label:"Search",...w("search")}),e.jsx(Q,{name:"types",toReadable:f.toReadable,control:h,items:f.toArray(),title:"Filter"}),e.jsx(U,{name:"sorting",control:h,title:"Sorting",toReadable:x.toReadable}),e.jsx(H,{type:"submit",children:"Apply"})]})}),e.jsxs("aside",{className:g.aside,children:[e.jsx(X,{onClick:d,children:e.jsx(Z,{})}),e.jsx(ae,{lastItemNode:G,onObserve:N,children:e.jsxs(e.Fragment,{children:[r&&t.length===0&&e.jsx(V,{}),t.map((a,m)=>e.jsxs(p,{children:[e.jsx(ie,{ref:m===t.length-1?M:null,genre:a}),e.jsx($,{})]},a.id))]})})]}),e.jsx(q,{})]})},je=n.memo(me);export{je as GenresPage};
