import{b as P,j as e,d as b,r as n,e as p,L as _,g as F,u as y,h as u,s as R,i as T,k as E,T as O,G as f,l as A,m as x,n as k,o as z,D as B,B as H,p as V,O as $,q}from"./index-22e6c56d.js";import{u as Y,T as J}from"./index.esm-583ec0a2.js";import{M as K,a as Q,P as U}from"./MultipleSelect-b56dfec5.js";import{I as W}from"./IconButton-d17f3bb9.js";import{D as X}from"./Divider-013c61dc.js";import"./GlobalStyles-4081b153.js";import"./listItemIconClasses-ff7500c2.js";const Z=P(e.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu"),ee=b(s=>s.genres.genres,s=>s),se=b(s=>s.genres.isLoading,s=>s),te=(s,t,r)=>{n.useEffect(()=>{if(s&&t){const c={root:s,threshold:0},o=new IntersectionObserver(i=>{i.every(l=>l.isIntersecting)&&r()},c);return o.observe(t),()=>{o.disconnect()}}},[s,t])},ne=({lastItemNode:s,onObserve:t,children:r})=>{const[c,o]=n.useState(null);te(c,s,t);const i=n.useCallback(l=>{o(l)},[]);return e.jsx(p,{sx:{position:"relative",flex:1,display:"flex",width:"100%"},children:e.jsx(_,{ref:i,sx:{overflowY:"auto",position:"absolute",inset:0},children:r})})},ae=n.memo(ne);class S{constructor({types:t,search:r}){this.types=t,this.search=r}}const re={"card-container":"_card-container_16fj8_1"},oe=n.forwardRef(({genre:s},t)=>{const r=F(),c=y(),o=u(R),i=()=>{o&&c(A()),r(`${s.id}`)};return e.jsx(T,{className:re["card-container"],ref:t,onClick:i,children:e.jsx(E,{primary:s.name,secondary:e.jsx(O,{component:"span",variant:"body2",color:"text.primary",children:f.toReadable(s.type)})})})}),ie=n.memo(oe),ce="_aside_138wd_1",le="_form_138wd_10",g={aside:ce,form:le},v=[{field:x.Name,direction:""},{field:x.Type,direction:""}],j={pagination:new U({pageSize:15,pageNumber:0}),sorting:v,filters:new S({types:[],search:""})},de={types:[],search:"",sorting:v},me=()=>{const s=y(),t=u(ee),r=u(se),[c,o]=n.useState(!1),[i,l]=n.useState(j),[G,I]=n.useState(null),N=()=>{l(a=>({...a,pagination:{...a.pagination,pageNumber:a.pagination.pageNumber+1}}))};n.useEffect(()=>{s(k())},[]),n.useEffect(()=>{s(z(i))},[i]);const{register:w,handleSubmit:C,control:h}=Y({defaultValues:de}),d=()=>{o(a=>!a)},L=({types:a,search:m,sorting:M})=>{s(q()),l({...j,sorting:M,filters:new S({types:a,search:m})}),d()},D=n.useCallback(a=>{I(a)},[]);return e.jsxs(p,{sx:{flex:1,display:"flex"},children:[e.jsx(B,{open:c,onClose:d,children:e.jsxs("form",{className:g.form,onSubmit:C(L),children:[e.jsx(J,{label:"Search",...w("search")}),e.jsx(K,{name:"types",toReadable:f.toReadable,control:h,items:f.toArray(),title:"Filter"}),e.jsx(Q,{name:"sorting",control:h,title:"Sorting",toReadable:x.toReadable}),e.jsx(H,{type:"submit",children:"Apply"})]})}),e.jsxs("aside",{className:g.aside,children:[e.jsx(W,{onClick:d,children:e.jsx(Z,{})}),e.jsx(ae,{lastItemNode:G,onObserve:N,children:e.jsxs(e.Fragment,{children:[r&&t.length===0&&e.jsx(V,{}),t.map((a,m)=>e.jsxs(p,{children:[e.jsx(ie,{ref:m===t.length-1?D:null,genre:a}),e.jsx(X,{})]},a.id))]})})]}),e.jsx($,{})]})},be=n.memo(me);export{be as GenresPage};
