var h=Object.defineProperty;var b=(n,e,t)=>e in n?h(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(b(n,typeof e!="symbol"?e+"":e,t),t);import"./modulepreload-polyfill-3cfb730f.js";class o{constructor(){r(this,"subscribers",new Set)}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notify(e){this.subscribers.forEach(t=>{t.update(e)})}}function y(n,e){const t=n+Math.random()*(e+1-n);return Math.floor(t)}class C extends o{update(e){this.notify({...e,dice:y(1,6)})}}class f extends o{constructor(){super(...arguments);r(this,"playersCount",0);r(this,"currentPlayerIndex",0)}turn(){const t=(this.currentPlayerIndex+1)%this.playersCount;this.notify({currentPlayerIndex:this.currentPlayerIndex,nextPlayerIndex:t}),this.currentPlayerIndex=t}}class p extends o{constructor(){super(...arguments);r(this,"results",[])}next(t){const s=[...this.results,t];this.results=s,this.notify(s)}getScore(){return this.results.reduce((t,s)=>t+s,0)}}class _{constructor(){r(this,"results",new p)}update(e){this.results.next(e.dice)}}const E=21;class x{constructor(e){r(this,"results",new p);r(this,"isActive",new o);r(this,"isWinner",new o);this.playerInfo=e}update(e){e.currentPlayerIndex===this.playerInfo.index&&this.results.next(e.dice),this.isActive.notify(e.nextPlayerIndex===this.playerInfo.index),this.isWinner.notify(this.results.getScore()>=E)}}class a{constructor(){r(this,"resultInfoElement",null);r(this,"resultScoreElement",null)}render(e){const t=document.createElement("p");t.className="result-item__player-name typography-subtitle",t.textContent=e;const s=document.createElement("p");s.className="result-item__player-points typography-subtitle",s.textContent="0 points";const l=document.createElement("div");l.className="result-item__player-info",l.appendChild(t),l.appendChild(s),this.resultInfoElement=l,this.resultScoreElement=s}update(e){this.resultScoreElement!==null&&(this.resultScoreElement.textContent=`${e.reduce((t,s)=>t+s,0)} points`)}}class S{constructor(){r(this,"resultStatusElement",null)}render(){const e=document.createElement("div");e.className="result_item__indicator",this.resultStatusElement=e}update(e){this.resultStatusElement!==null&&(e?this.resultStatusElement.classList.add("result_item__indicator_active"):this.resultStatusElement.classList.remove("result_item__indicator_active"))}}class c{constructor(){r(this,"resultsContainer",null);r(this,"resultsValueContainer",null)}render(){const e=document.createElement("p");e.className="result_item__moves-subtitle typography-subtitle",e.textContent="Moves";const t=document.createElement("p");t.className="result-item__moves-data typography-body";const s=document.createElement("div");s.className="result-item__moves",s.appendChild(e),s.appendChild(t),this.resultsContainer=s,this.resultsValueContainer=t}update(e){this.resultsValueContainer!==null&&(this.resultsValueContainer.textContent=e.join(""))}}class d{constructor(){r(this,"resultElement",null)}render({resultInfo:e,resultStatus:t,resultTurns:s,className:l}){const i=document.querySelector(".blackjack__results");if(i===null)return;const u=document.createElement("div");u.className=`blackjack__result-item result-item ${l??""}`,e!==null&&u.appendChild(e),t!==null&&u.appendChild(t),s!==null&&u.appendChild(s),i.appendChild(u),this.resultElement=u}update(e){this.resultElement!==null&&e&&this.resultElement.classList.add("result-item_winner")}}const m=[{name:"Player First"},{name:"Player Second"}];class I{constructor(){r(this,"turnGenerator",new f);r(this,"diceGenerator",new C)}init(){for(let e=0;e<m.length;e++)this.initPlayer({...m[e],index:e}),this.turnGenerator.playersCount+=1;this.initDiceResults(),this.turnGenerator.subscribe(this.diceGenerator),this.listenTurn()}initPlayer(e){const t=new a;t.render(e.name);const s=new S;s.render();const l=new c;l.render();const i=new d;i.render({resultInfo:t.resultInfoElement,resultStatus:s.resultStatusElement,resultTurns:l.resultsContainer});const u=new x(e);u.results.subscribe(t),u.results.subscribe(l),u.isActive.subscribe(s),u.isWinner.subscribe(i),this.diceGenerator.subscribe(u)}initDiceResults(){const e=new a;e.render("Dice");const t=new c;t.render(),new d().render({resultInfo:e.resultInfoElement,resultStatus:null,resultTurns:t.resultsContainer,className:"game-result"});const l=new _;l.results.subscribe(e),l.results.subscribe(t),this.diceGenerator.subscribe(l)}listenTurn(){const e=document.querySelector(".blackjack__turn-button");e&&e.addEventListener("click",()=>{this.turnGenerator.turn()})}}const w=new I;w.init();
